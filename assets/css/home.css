/* =======================================================================
   KRAS-TRANS • HOME.CSS (v3)
   - 2 tryby animacji: Calm / Vivid (data-anim-mode na <html>)
   - Container queries, fluid type, real 3D hover (pointer=fine)
   - A11y, scroll-padding pod sticky header, sekcja „see-also”
   ======================================================================= */

@layer tokens, base, layout, components, effects, utilities;

@layer tokens{
  :root{
    --bg:#0b1020; --bg-2:#0e152d; --surface:#111732; --surface-2:#0d1430;
    --txt:#e9edf6; --muted:#a3adbd; --border:#1f2742;
    --accent:#2ac3ff; --accent-2:#2dd4bf; --warning:#f59e0b; --ok:#22c55e; --danger:#ef4444;
    --shadow-1: 0 10px 24px rgba(0,0,0,.20); --shadow-2: 0 16px 36px rgba(0,0,0,.28);
    --radius-1:14px; --radius-2:20px;
    --g-accent: linear-gradient(135deg,#2ac3ff 0%,#7c3aed 35%,#2dd4bf 70%,#f59e0b 100%);
    --g-surface: linear-gradient(180deg,#0e152d 0%,#0b1020 100%);
    --g-tile: radial-gradient(120% 160% at 20% 0%, rgba(42,195,255,.12) 0%, rgba(125,0,255,.10) 35%, rgba(45,212,191,.08) 65%, rgba(245,158,11,.05) 100%);
    --line-1: repeating-linear-gradient(90deg, rgba(42,195,255,.35) 0 14px, transparent 14px 24px);
    --line-2: repeating-linear-gradient(90deg, rgba(45,212,191,.35) 0 12px, transparent 12px 20px);
    --line-3: linear-gradient(90deg, rgba(245,158,11,.5), rgba(124,58,237,.5), rgba(42,195,255,.5));
    --fs-hero: clamp(28px, 4.2vw, 52px); --fs-h2: clamp(22px, 2.6vw, 34px); --fs-h3: clamp(18px, 2.1vw, 22px); --fs-body: clamp(16px, 1.4vw, 17px);
    --fw-title:800; --fw-head:700; --fw-body:400;
    --grid-max: 1280px; --gutter: 20px; --section-pad: clamp(48px, 8vw, 120px);
    --cis-hero: 720px; --cis-tile: 260px;
    --header-offset: 64px;
    /* amplitudy animacji (zmienne zmieniane przez tryb) */
    --tilt-r: 0.5deg; --lift: 6px; --parallax: 10px; --pulse: 2.2s;
  }
  html[data-anim-mode="vivid"]{
    --tilt-r: 1.5deg; --lift: 10px; --parallax: 16px; --pulse: 1.8s;
  }
  @media (prefers-color-scheme: light){
    :root{
      --bg:#ffffff; --bg-2:#f7f9fc; --surface:#ffffff; --surface-2:#f4f7ff;
      --txt:#0d1323; --muted:#535e73; --border:#e6eaf2;
      --shadow-1:0 10px 22px rgba(17,23,50,.08); --shadow-2:0 16px 36px rgba(17,23,50,.10);
      --g-surface:linear-gradient(180deg,#f7f9fc 0%,#ffffff 100%);
    }
  }
}

@layer base{
  *,*::before,*::after{box-sizing:border-box}
  html{scroll-behavior:smooth;text-size-adjust:100%;-webkit-text-size-adjust:100%}
  body{margin:0;background:var(--bg);color:var(--txt);font:var(--fs-body)/1.55 system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial}
  img,svg,video{max-width:100%;height:auto;display:block}
  a{color:inherit;text-decoration:none}
  :focus-visible{outline:2px solid var(--accent-2);outline-offset:2px;border-radius:8px}
  .visually-hidden{position:absolute!important;height:1px;width:1px;overflow:hidden;clip:rect(1px,1px,1px,1px);white-space:nowrap}
  .kt-body{ scroll-padding-top: calc(var(--header-offset) + 8px); }
}

@layer layout{
  .container{width:min(var(--grid-max), 100% - (var(--gutter)*2));margin-inline:auto}
  .section{position:relative;padding-block:var(--section-pad);background:var(--g-surface);content-visibility:auto;contain:content;contain-intrinsic-size:1px var(--cis-hero)}
  .section.tiles{contain-intrinsic-size:1px var(--cis-tile)}
  .section-head{display:flex;align-items:flex-end;justify-content:space-between;gap:16px;margin-bottom:clamp(16px,2.6vw,28px)}
  .section-head h2{font-size:var(--fs-h2);line-height:1.15;margin:0;font-weight:var(--fw-head)}
  .section-head p{margin:0;color:var(--muted)}
  .section::before,.section::after{content:"";position:absolute;left:0;right:0;height:14px;pointer-events:none;background:var(--line-3);background-size:200% 100%;animation:lineShift 14s linear infinite;mask:linear-gradient(#000,#000) content-box,linear-gradient(#000,#000);-webkit-mask-composite:xor;mask-composite:exclude}
  .section::before{top:-1px;padding-inline:10px}
  .section::after{bottom:-1px;padding-inline:40px;filter:saturate(120%) opacity(.8)}
  @keyframes lineShift{to{background-position:200% 0}}
}

@layer components{
  .hero .claim{margin:0 0 8px 0;text-transform:uppercase;letter-spacing:.18em;font-size:12px;color:transparent;background:linear-gradient(90deg,#8ab4ff,#2dd4bf,#f59e0b,#8ab4ff);-webkit-background-clip:text;background-clip:text;background-size:200% 100%;animation:claimMove 18s linear infinite}
  @keyframes claimMove{to{background-position:200% 0}}
  .hero h1{font-size:var(--fs-hero);line-height:1.08;margin:0 0 10px 0;font-weight:var(--fw-title)}
  .hero .lead{max-width:70ch;color:var(--muted);margin:0 0 18px 0}
  .cta-row{display:flex;gap:10px;flex-wrap:wrap}
  .btn{display:inline-flex;align-items:center;justify-content:center;gap:10px;height:44px;padding:0 16px;border-radius:999px;font-weight:700;border:1px solid transparent;transition:transform .2s ease,box-shadow .2s ease,filter .2s ease}
  .btn:active{transform:translateY(1px)}
  .btn-primary{background:var(--accent-2);color:#00131a;box-shadow:0 10px 24px rgba(45,212,191,.2)}
  .btn-primary:hover{filter:brightness(1.06)}
  .btn-ghost{background:transparent;border-color:color-mix(in oklab,var(--accent-2) 35%, var(--txt));color:var(--txt)}
  .btn-ghost:hover{border-color:var(--accent-2)}
  .hero-top{display:grid;gap:10px}
  .hero-switch{display:flex;gap:8px;margin-top:6px}
  .hero-switch .switch{height:32px;padding:0 12px;border-radius:999px;border:1px solid var(--border);background:color-mix(in oklab,var(--surface) 90%, transparent);color:var(--txt);font-weight:700}
  .hero-switch .switch.active{background:var(--accent-2);color:#00131a;border-color:transparent}

  .hero-stats{display:flex;gap:12px;flex-wrap:wrap;margin:14px 0 0;padding:0;list-style:none}
  .hero-stats li{display:flex;flex-direction:column;align-items:flex-start;gap:2px;padding:10px 12px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));border:1px solid var(--border);box-shadow:var(--shadow-1)}
  .hero-media{margin-top:18px;border-radius:var(--radius-2);overflow:hidden;box-shadow:var(--shadow-2);background:var(--g-tile)}
  .hero-media img{width:100%;aspect-ratio:16/9;object-fit:cover;transform:translateZ(0)}

  .reel{display:grid;grid-auto-flow:column;grid-auto-columns:80%;gap:12px;overflow-x:auto;overscroll-behavior-x:contain;scroll-snap-type:x mandatory;padding:4px 2px 12px;-webkit-overflow-scrolling:touch;scrollbar-width:thin}
  .reel>*{scroll-snap-align:start}
  .reel::-webkit-scrollbar{height:8px}
  .reel::-webkit-scrollbar-thumb{background:linear-gradient(90deg, rgba(255,255,255,.18), rgba(255,255,255,.06));border-radius:12px}
  @media (min-width: 900px){ .reel{grid-auto-flow:row;grid-auto-columns:initial;grid-template-columns:repeat(4,minmax(0,1fr));overflow:visible;padding:0} }
  .tile3d{position:relative;background:color-mix(in oklab,var(--surface) 70%, transparent);border:1px solid var(--border);border-radius:var(--radius-2);box-shadow:var(--shadow-1);padding:18px 16px 16px;min-height:190px;transition:transform .25s ease, box-shadow .25s ease, filter .25s ease, border-color .25s ease;isolation:isolate;background-image:var(--g-tile);transform:translateZ(0)}
  .tile3d::before{content:"";position:absolute;inset:-1px;border-radius:inherit;padding:1px;background:conic-gradient(from 0deg, rgba(42,195,255,.25), rgba(124,58,237,.25), rgba(45,212,191,.25), rgba(245,158,11,.25), rgba(42,195,255,.25));-webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);-webkit-mask-composite:xor;mask-composite:exclude;pointer-events:none;opacity:.6;filter:saturate(120%);animation:ring 26s linear infinite}
  @keyframes ring{to{transform:rotate(360deg)}}
  .tile3d h3{margin:0 0 6px 0;font-size:var(--fs-h3)}
  .tile3d p{margin:0 0 10px 0;color:var(--muted)}
  .tile-link{display:inline-flex;align-items:center;gap:8px;font-weight:700;position:relative}
  .tile-link::after{content:"›";transition:transform .2s ease}
  .tile-link:hover::after{transform:translateX(2px)}

  /* Reel controls */
  .reel-controls{display:flex;align-items:center;gap:8px;margin-top:8px}
  .reel-prev,.reel-next{width:32px;height:32px;border-radius:8px;border:1px solid var(--border);background:color-mix(in oklab,var(--surface) 90%, transparent);color:var(--txt);font-weight:700}
  .reel-prev:disabled,.reel-next:disabled{opacity:.4}
  .reel-progress{flex:1;height:6px;border-radius:6px;background:rgba(255,255,255,.08);overflow:hidden;border:1px solid var(--border)}
  .reel-progress span{display:block;height:100%;width:0;background:linear-gradient(90deg,#2dd4bf,#2ac3ff)}
  .reel.is-dragging{cursor:grabbing}

  /* See-also (fallback autolinks) */
  .see-also.cards{display:grid;grid-template-columns:repeat(1,minmax(0,1fr));gap:12px;margin-top:8px}
  @media (min-width:680px){ .see-also.cards{grid-template-columns:repeat(2,minmax(0,1fr))} }
  @media (min-width:980px){ .see-also.cards{grid-template-columns:repeat(3,minmax(0,1fr))} }
  .see-also .tile3d{min-height:140px}

  /* FOOTER */
  .footer{background: linear-gradient(180deg, var(--bg) 0%, #050814 100%); color:var(--txt)}
  .footer-grid{display:grid;gap:16px;grid-template-columns: repeat(2,minmax(0,1fr))}
  .footer .col{background: color-mix(in oklab, var(--surface-2) 70%, transparent); padding:12px; border:1px solid var(--border); border-radius: var(--radius-1)}
  .contact-list, .social{list-style:none; padding:0; margin:0}
  .contact-list a, .social a{display:inline-flex; gap:8px; padding:8px 0}
  .mini-nav{display:flex; flex-wrap:wrap; gap:8px}
  .mini-nav a{padding:6px 10px; border:1px solid var(--border); border-radius:10px}
  .mini-nav a:hover{border-color:var(--accent-2)}
  .copyright{margin:12px 0 0 0; color:var(--muted); text-align:center}

  @media (min-width: 900px){ .footer-grid{grid-template-columns: 1.2fr 1fr 1fr 1fr} }
}

@layer effects{
  .section.alt-1{background:radial-gradient(60% 100% at 50% 0%, rgba(42,195,255,.18), transparent 60%), var(--g-surface)}
  .section.alt-2{background:radial-gradient(80% 100% at 50% 100%, rgba(124,58,237,.14), transparent 60%), var(--g-surface)}
  .section.alt-3{background:radial-gradient(120% 60% at 0% 0%, rgba(45,212,191,.18), transparent 60%), var(--g-surface)}
  .section.alt-4{background:radial-gradient(120% 60% at 100% 100%, rgba(245,158,11,.14), transparent 60%), var(--g-surface)}
  /* Vivid: mocniejsze parallax/tilt dla pointer=fine */
  @media (hover:hover){
    html[data-anim-mode="vivid"] .tile3d{transform-style:preserve-3d; perspective:900px}
    html[data-anim-mode="vivid"] .tile3d:hover{transform:translateY(calc(-1*var(--lift))) scale(1.01) rotateX(var(--tilt-r)) rotateY(calc(-1*var(--tilt-r)))}
    html[data-anim-mode="vivid"] .hero-media img{transition:transform .45s ease}
    html[data-anim-mode="vivid"] .in[data-anim="parallax"] .hero-media img{transform:translateY(calc(var(--parallax))) scale(1.02)}
  }
  @media (prefers-reduced-motion: reduce){
    *{animation-duration:.001ms!important;animation-iteration-count:1!important;transition-duration:.001ms!important;scroll-behavior:auto!important}
  }
}

@layer utilities{
  .flow > * + *{margin-top:.6em}
  .badge{display:inline-flex;align-items:center;gap:8px;height:28px;padding:0 10px;border-radius:999px;background:rgba(255,255,255,.06);border:1px solid var(--border);font-weight:700}
  .progress-bar{position:fixed;top:0;left:0;height:3px;width:0;background:var(--g-accent);z-index:2000}
  /* Container queries */
  @supports (container-type:inline-size){
    .container{container-type:inline-size; container-name:wrap}
    @container wrap (max-width: 700px){
      .section-head{flex-direction:column;align-items:flex-start}
      .reel{grid-auto-columns:92%}
    }
  }
}
