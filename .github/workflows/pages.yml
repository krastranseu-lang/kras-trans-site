version: 1

site:
  brand: "Kras-Trans"
  legalName: "Kras-Trans Sp. z o.o."
  url: "https://kras-trans.com"
  defaultLang: "pl"
  locales:
    pl: { name: "Polski",  flag: "/assets/flags/pl.svg" }
    en: { name: "English", flag: "/assets/flags/en.svg" }
    de: { name: "Deutsch", flag: "/assets/flags/de.svg" }
    fr: { name: "Fran√ßais",flag: "/assets/flags/fr.svg" }
    it: { name: "Italiano",flag: "/assets/flags/it.svg" }
    ru: { name: "–†—É—Å—Å–∫–∏–π", flag: "/assets/flags/ru.svg" }
    ua: { name: "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞", flag: "/assets/flags/ua.svg" }
  brandAssets:
    logo:   "/assets/media/logo.png"
    logo2x: "/assets/media/logo@2x.png"
    ogDefault: "/assets/media/og-default.webp"
  contacts:
    phone: "+48 123 456 789"
    email: "info@kras-trans.com"
    address: "≈Å√≥d≈∫, Polska"
    social:
      - { id: "facebook", href: "https://facebook.com/krastrans" }
      - { id: "linkedin", href: "https://linkedin.com/company/kras-trans" }
  analytics:
    ga_id_env: "GA_ID"                  # pobierze z ENV (workflow)
  verification:
    gsc_env: "GSC_VERIFICATION"         # meta name="google-site-verification"
  security:
    referrerPolicy: "strict-origin-when-cross-origin"
    externalLinks: "noopener"           # wszystkie linki off-site dostajƒÖ rel
    targetBlankExternal: true
    csp:
      # minimalistyczne CSP ‚Äì rozszerzymy p√≥≈∫niej przy wdro≈ºeniu formularzy
      default-src: ["'self'"]
      img-src:     ["'self'", "data:", "https:"]
      style-src:   ["'self'", "'unsafe-inline'"]
      script-src:  ["'self'", "https://script.google.com"]
      connect-src: ["'self'", "https://script.google.com"]

cms:
  # Endpoint podawany z Secrets w Actions; build.py u≈ºyje APPS_URL/APPS_KEY
  endpoint_env: "APPS_URL"
  key_env: "APPS_KEY"
  # Struktura oczekiwana z Apps Script (masz to w doGet) ‚Äî wa≈ºne przy walidacji:
  expects: ["ok","updated","pages","nav","routes","strings","faq","places","autolinks","hreflang","sitemap"]
  client:
    # Na etapie P0: bez cache po stronie przeglƒÖdarki ‚Äì zmiany w arkuszu widaƒá od razu
    cache: false
    # Gdy URL nie ma /{lang}/ ‚Üí przekieruj do domy≈õlnego
    enforceLangRedirect: true

paths:
  src:
    templates: "templates"
    assets:    "assets"
    data:      "data"
    tools:     "tools"
  out: "dist"

templates:
  base: "templates/base.html"
  header: "templates/header.html"
  page: "templates/page.html"
  # opcjonalne (kompilacja nie zawiedzie, gdy brak ‚Äî sprawdza to sanity z workflow)
  blog_index: "templates/blog_index.html"
  blog_post:  "templates/blog_post.html"
  case_index: "templates/case_index.html"
  case_item:  "templates/case_item.html"
  reviews:    "templates/reviews.html"
  location:   "templates/location.html"
  jobs_index: "templates/jobs_index.html"
  job_item:   "templates/job_item.html"

assets:
  css:
    # Header i baza strony (sp√≥jne z motywami z home.css)
    - "/assets/css/header.css"
    - "/assets/css/home.css"
  js:
    - "/assets/js/header.js"
    - "/assets/js/home.js"
  preload:
    - { as: "style", href: "/assets/css/header.css" }
    - { as: "image", href: "/assets/media/logo.png" }
  flagsPath: "/assets/flags"

header:
  # konfiguracja headera/mega-menu i mobilnego docka
  ctaSlugKey: "quote"
  mega:
    columnsDefault: 4
    groups:
      services:
        labelKey: "Us≈Çugi"     # fallback; w≈Ça≈õciwe etykiety pobierzemy z CMS->nav/strings
        columns: 5
        order: 60
      manage:
        labelKey: "ZarzƒÖdzaj"
        columns: 4
        order: 50
      company:
        labelKey: "Firma"
        columns: 3
        order: 70
      support:
        labelKey: "Wsparcie"
        columns: 3
        order: 80
  dock:
    items:
      - { slugKey: "home",     icon: "üè†", label_pl: "Start" }
      - { slugKey: "services", icon: "üß≠", label_pl: "Us≈Çugi" }
      - { slugKey: "quote",    icon: "üí∏", label_pl: "Wycena" }
      - { slugKey: "contact",  icon: "ü§ô", label_pl: "Kontakt" }

routes:
  # ≈πr√≥d≈Çem prawdy sƒÖ CMS->Routes (slugKey ‚Üí slugi per jƒôzyk).
  # Tu definiujemy tylko listƒô slugKey u≈ºywanych w nawigacji/IA.
  keys:
    - home
    - pricing
    - order
    - schedules
    - tracking
    - manage
    - services
    - company
    - support
    - blog
    - contact
    # Dodatkowe, czƒôsto u≈ºywane podstrony:
    - quote
    - fleet
    - careers
    - reviews
    - api
    - documents
    - invoices
    - finances
    - faq
    - legal
    - media
    - team
    - cases

navigation:
  # Kolejno≈õƒá top-level ‚Äî fallback (gdyby CMS nie mia≈Ç kolejno≈õci)
  top:
    - { label: "Cennik",     slugKey: "pricing", order: 10 }
    - { label: "Zam√≥w",      slugKey: "order",   order: 20 }
    - { label: "Harmonogramy", slugKey: "schedules", order: 30 }
    - { label: "≈öledzenie",  slugKey: "tracking",order: 40 }
    - { label: "ZarzƒÖdzaj",  slugKey: "manage",  order: 50 }
    - { label: "Us≈Çugi",     slugKey: "services",order: 60 }
    - { label: "Firma",      slugKey: "company", order: 70 }
    - { label: "Wsparcie",   slugKey: "support", order: 80 }
    - { label: "Blog",       slugKey: "blog",    order: 90 }
    - { label: "Kontakt",    slugKey: "contact", order: 100 }
  # ‚ÄûUs≈Çugi‚Äù ‚Äî plan kolumn (fallback; w≈Ça≈õciwy layout steruje CMS.nav[col])
  services_columns:
    - "Transport (krajowy, miƒôdzynarodowy, palety, ekspres)"
    - "SLA / Operacje (SLA, busy 3,5 t)"
    - "Wsparcie (dyspozytor, logistyka kontraktowa)"
    - "Specjalizacje (TIR/FTL, przeprowadzki, e‚Äëcommerce)"
    - "Oferta (cennik, wycena)"

collections:
  # 1) Strony podstawowe z CMS Pages
  pages:
    source: "cms.pages"
    filter: { publish: true }
    perLocale: true
    # mapping typ‚Üíszablon; gdy brak ‚Äî u≈ºyj "page.html"
    templates:
      home: "templates/page.html"
      page: "templates/page.html"
      service: "templates/page.html"
      city_service: "templates/location.html"
      contact: "templates/page.html"
      blog: "templates/blog_index.html"
      blog_post: "templates/blog_post.html"
    output:
      pattern: "/{lang}/{slug}/"            # pusty slug ‚Üí "/{lang}/"
      ensureTrailingSlash: true
    seo:
      titleSuffix: " | Kras-Trans"
      canonicalFrom: "canonical_path"       # je≈ºeli brak ‚Üí konstruujemy z lang/slug
      og_image_fallback: "/assets/media/og-default.webp"
      breadcrumbs: true
      hreflang: from-cms                    # u≈ºyj cms.hreflang[slugKey]
  # 2) Generator ‚ÄûMiasto √ó Us≈Çuga‚Äù (skala 10k+)
  city_service:
    generate: true
    # ≈πr√≥d≈Ça do kombinacji:
    places:   "cms.places"                  # arkusz Places (miasta/woj.) ‚Äî z Apps Script
    services: "cms.pages[type=service]"     # bierz tylko opublikowane us≈Çugi
    langs: ["pl","en","de","fr","it","ru","ua"]
    limits:
      maxPages: 20000                        # bezpieczny sufit
      perLang: 4000
    # Polityka budowy slug√≥w/tytu≈Ç√≥w (gdy CMS nie poda gotowych):
    slugPolicy:
      # pattern mo≈ºe wykorzystaƒá: {service.slug}, {city.slug}, {city.voivodeship}
      pattern: "{service.slug}-{city.slug}"
      transliterate: true
      lowercase: true
    fields:
      type: "city_service"
      template: "templates/location.html"
      publish: true
      # generowanie SEO/CTA ‚Äì fallback (CMS i tak potrafi to policzyƒá, ale trzymamy zgodno≈õƒá)
      h1: "{service.h1} ‚Äî {city.name}"
      title: "{service.title} ‚Äî {city.name}"
      seo_title: "{service.h1} ‚Äî {city.name} | Kras-Trans"
      meta_desc: "Transport i spedycja ‚Äî {service.h1} w {city.name}. Wycena w 15 min, kontakt 24/7."
      hero_alt: "{service.h1} {city.name}"
      lead: "{service.lead or service.title}"
    output:
      pattern: "/{lang}/{slug}/"
      ensureTrailingSlash: true
    linkGraph:
      # Autolinkowanie miƒôdzy sƒÖsiadujƒÖcymi miastami/us≈Çugami
      maxOutlinks: 6
      cityNeighbors: 2
      serviceAlternatives: 2

autolinks:
  source: "cms.autolinks"   # arkusz AutoLinks (masz w Apps Script)
  insert:
    maxPerPage: 6
    minDistanceChars: 160
    titleAttr: true         # tytu≈Ç linku = anchor
  sanitize:
    stripNestedLinks: true
    ignoreSelectors: [".hero", ".footer", "nav"]

seo:
  openGraph:
    type: "website"
    site_name: "Kras-Trans"
  twitter:
    card: "summary_large_image"
  robots:
    # globalne domy≈õlne
    index: true
    follow: true
  pagination:
    relPrevNext: true
  breadcrumbs:
    jsonld: true

sitemap:
  enabled: true
  path: "/sitemap.xml"
  include:
    - "/pl/**"
    - "/en/**"
    - "/de/**"
    - "/fr/**"
    - "/it/**"
    - "/ru/**"
    - "/ua/**"
  exclude:
    - "/**/draft/**"
  priority:
    home: 1.0
    service: 0.9
    city_service: 0.8
    page: 0.7
    blog: 0.6
    blog_post: 0.5
  changefreq:
    home: "daily"
    service: "weekly"
    city_service: "weekly"
    page: "monthly"

robots:
  # Prosty robots.txt z odniesieniem do sitemap
  allowAll: true
  cleanParam: []
  extra:
    - "User-agent: *"
    - "Allow: /"
    - "Sitemap: https://kras-trans.com/sitemap.xml"

redirects:
  # 1) Z CMS (arkusz Redirects) ‚Äî front/prompter je czyta w trakcie builda
  fromCms: true
  # 2) Brak /{lang}/ w URL ‚Üí redirect do domy≈õlnego jƒôzyka
  enforceLang: true
  defaultLang: "pl"

performance:
  goals:
    lcp_ms: 2500
    tbt_ms: 100
    cls: 0.02
  images:
    generate:
      avif: true
      webp: true
      quality: 78
    lqip:
      enabled: true
      size: 12
  scripts:
    deferAll: true
    module: false
    sourcemaps: false
  css:
    inlineCriticalHeader: true   # 1‚Äì2 KB crit. CSS dla paska
    minify: true

features:
  header:
    hoverIntent: { open_ms: 140, close_ms: 380 }
    bottomDock: true
    themeToggle: true
  blog:
    enabled: true
    rss: true
  jobs:
    enabled: true
  reviews:
    enabled: true
  tracking:
    liveMap: false   # placeholder pod przysz≈Çe osadzenie map
  forms:
    leads:
      endpoint: "post {APPS_URL}?key={APPS_KEY}&action=lead"
      method: "POST"

testing:
  acceptance:
    - "URL bez /xx/ ‚Üí redirect do /pl/"
    - "Logo ‚Üí zawsze /{lang}/"
    - "Zmiana jƒôzyka ‚Üí /{lang}/{homeSlug?}/"
    - "Mega-menu: open 140ms, close 360‚Äì420ms"
    - "Bottom-dock: sticky na mobile + FAB"
    - "Lighthouse: Perf‚â•95, A11y‚â•95, BP‚â•95, SEO‚â•98"
    - "CLS ‚âà 0"
  smoke:
    - "dist/sitemap.xml"
    - "dist/robots.txt"
    - "dist/pl/index.html"

build:
  # Parametry u≈ºywane przez tools/build.py (dzisiejsza wersja ‚Äûmini‚Äù)
  engine: "jinja2"
  markdown: true
  env:
    site_url_env: "SITE_URL"
    brand_env: "BRAND"
    cname_env: "CNAME"
  snapshots:
    zip: true
    path: "dist/download/site.zip"
